<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FATALITY | Streetwear Minimal</title>
    <meta name="description" content="FATALITY: prendas dise√±adas para durar, inspiradas en el movimiento Nomad. Streetwear minimal con actitud.">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        /* --- VARIABLES Y RESET --- */
        :root {
            --primary: #111111;
            --accent: #ff3e3e;
            --text-dark: #222222;
            --text-light: #f5f5f5;
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: 1px solid rgba(255, 255, 255, 0.3);
            --shadow-sm: 0 4px 6px rgba(0,0,0,0.05);
            --shadow-lg: 0 20px 25px rgba(0,0,0,0.15);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        * { box-sizing: border-box; }
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0; padding: 0;
            color: var(--text-dark);
            overflow-x: hidden;
            background-color: #f0f0f0;
        }
        /* --- PARALLAX BACKGROUND --- */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            will-change: transform;
        }
        /* --- HEADER GLASSMORPHISM --- */
        header {
            background: rgba(17, 17, 17, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--text-light);
            padding: 1rem 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .logo { font-size: 1.8rem; font-weight: 800; letter-spacing: 3px; text-transform: uppercase; color: var(--text-light); }
        .header-right {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        .music-toggle, .cart-icon {
            cursor: pointer;
            position: relative;
            font-size: 1.4rem;
            transition: var(--transition);
        }
        .music-toggle:hover, .cart-icon:hover { transform: scale(1.1); color: var(--accent); }
        .cart-count { 
            position: absolute; top: -5px; right: -8px; background: var(--accent); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; justify-content: center; align-items: center; font-size: 0.75rem; font-weight: 600; }
        /* --- LAYOUT PRINCIPAL --- */
        .main-content {
            position: relative;
            z-index: 1;
            padding: 4rem 0;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
        .gallery-title {
            text-align: center; color: var(--text-light);
            font-size: 2.5rem; font-weight: 800;
            margin-bottom: 3rem; text-transform: uppercase; letter-spacing: 2px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2.5rem;
        }
        /* --- TARJETA DE PRODUCTO --- */
        .product-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: var(--glass-border);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
        }
        .product-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: var(--shadow-lg);
        }
        .tshirt-visual {
            position: relative;
            height: 420px;
            background: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            padding: 30px 0;
        }
        .tshirt-svg {
            width: 92%;
            height: auto;
            display: block;
            filter: drop-shadow(0 12px 20px rgba(0,0,0,0.25));
            transition: var(--transition);
        }
        .product-card:hover .tshirt-svg { transform: scale(1.08); }
        .stamp-area {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -48%);
            width: 55%;
            max-width: 260px;
            aspect-ratio: 1/1;
            display: flex; justify-content: center; align-items: center;
            z-index: 10; pointer-events: none;
        }
        .stamp-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            filter: brightness(1) contrast(1.15) drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        }
        .product-info { padding: 1.8rem; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; text-align: left;}
        .product-title { font-size: 1rem; margin: 0 0 8px; font-weight: 600; color: var(--text-dark); }
        .product-price { color: var(--accent); font-size: 1.35rem; font-weight: 800; margin-bottom: 20px; }
        .controls { margin-bottom: 20px; }
        .label { font-size: 0.75rem; font-weight: 600; color: #666; margin-bottom: 8px; display: block; text-transform: uppercase; letter-spacing: 1px;}
        .color-options { display: flex; gap: 12px; margin-bottom: 15px; }
        .color-btn {
            width: 32px; height: 32px;
            border-radius: 50%;
            border: 2px solid rgba(0,0,0,0.1);
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }
        .color-btn:hover { transform: scale(1.1); }
        .color-btn.active::after {
            content: ''; position: absolute; top: -4px; left: -4px; right: -4px; bottom: -4px;
            border-radius: 50%; border: 2px solid var(--accent);
            opacity: 1; transform: scale(1);
        }
        select.size-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #eee;
            border-radius: 8px;
            background: white;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            color: var(--text-dark);
            cursor: pointer;
            outline: none;
            transition: var(--transition);
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23111111%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 15px top 50%;
            background-size: 12px auto;
        }
        select.size-select:focus { border-color: var(--accent); }
        .add-btn {
            background: var(--primary);
            color: white;
            border: none; width: 100%; padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 800; letter-spacing: 1px;
            transition: var(--transition);
            position: relative; overflow: hidden; z-index: 1;
        }
        .add-btn::before {
            content: ''; position: absolute; top: 0; left: 0; width: 0%; height: 100%;
            background: var(--accent); z-index: -1; transition: var(--transition);
        }
        .add-btn:hover::before { width: 100%; }
        /* --- CARRITO MODAL --- */
        .modal {
            display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: white; margin: 5vh auto; padding: 2.5rem;
            width: 90%; max-width: 500px;
            border-radius: 20px; box-shadow: var(--shadow-lg);
            max-height: 90vh; overflow-y: auto; position: relative;
        }
        .close { float: right; font-size: 2rem; cursor: pointer; color: #999; transition: var(--transition); }
        .close:hover { color: var(--accent); transform: rotate(90deg); }
        .cart-items { border-bottom: 2px solid #f0f0f0; margin-bottom: 1.5rem; max-height: 250px; overflow-y: auto; padding-right: 10px;}
        .cart-item { display: flex; justify-content: space-between; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px dotted #eee; align-items: center; }
        .cart-item-img { width: 60px; height: 60px; object-fit: contain; background: #eee; border-radius: 8px; margin-right: 15px; }
        .delete-btn { color: #ff3e3e; background: rgba(255, 62, 62, 0.1); border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.7rem; font-weight: 600; transition: var(--transition);}
        .delete-btn:hover { background: #ff3e3e; color: white; }
        .form-group { margin-bottom: 1.2rem; }
        .form-group label { display: block; margin-bottom: 8px; font-size: 0.85rem; font-weight: 600; color: #555; }
        .form-group input, .form-group select {
            width: 100%; padding: 14px;
            border: 2px solid #eee; border-radius: 8px;
            font-family: 'Montserrat', sans-serif; transition: var(--transition); outline: none;
        }
        .form-group input:focus, .form-group select:focus { border-color: var(--accent); box-shadow: 0 0 0 4px rgba(255, 62, 62, 0.1); }
        .checkout-btn {
            background: #25D366; color: white; width: 100%; padding: 18px;
            border: none; border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 900;
            letter-spacing: 1px;
            cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 12px;
            transition: var(--transition); box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
            text-transform: uppercase;
        }
        .checkout-btn:hover { background: #128C7E; transform: translateY(-3px); box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4); }
        .payment-note {
            text-align: center;
            margin-top: 1.5rem;
            font-weight: 600;
            color: #333;
        }
        footer { background: var(--primary); color: rgba(255,255,255,0.6); text-align: center; padding: 3rem 1rem; margin-top: 0; position: relative; z-index: 2;}
        footer p { font-size: 0.9rem; font-weight: 600; }
    </style>
</head>
<body>
    <!-- AUDIO BACKGROUND -->
    <audio id="bg-music" loop>
        <source src="Nocturna en Buenos Aires.mp3" type="audio/mpeg">
        Tu navegador no soporta audio HTML5.
    </audio>

    <header>
        <div class="logo">FATALITY</div>
        <div class="header-right">
            <div class="music-toggle" id="music-toggle" onclick="toggleMusic()" title="Activar/Desactivar m√∫sica">
                üîä
            </div>
            <div class="cart-icon" onclick="openCart()">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                <span id="cart-count" class="cart-count">0</span>
            </div>
        </div>
    </header>
    <div class="main-content">
        <div class="container">
            <h2 class="gallery-title">Colecci√≥n Nomad // 100 Modelos</h2>
            <div id="products-grid" class="products-grid"></div>
        </div>
    </div>
    <div id="cartModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCart()">&times;</span>
            <h2>Tu Pedido</h2>
           
            <div id="cart-items" class="cart-items">
                <p style="text-align:center; color:#999;">El carrito est√° vac√≠o</p>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin: 1.5rem 0; font-size: 1.2rem;">
                <span>Total Estimado:</span>
                <span style="font-weight: 800; color: var(--primary);">$<span id="cart-total">0</span></span>
            </div>
            <hr style="border: none; border-top: 1px solid #eee; margin: 1.5rem 0;">
            <h3>Finalizar Compra</h3>
            <p style="font-size: 0.85rem; color: #666; margin-bottom: 1.5rem;">Completa tus datos para enviar el pedido por WhatsApp.</p>
            <form id="checkout-form" onsubmit="sendToWhatsApp(event)">
                <div class="form-group">
                    <label>Nombre Completo *</label>
                    <input type="text" id="name" required>
                </div>
                <div class="form-group">
                    <label>DNI *</label>
                    <input type="text" id="dni" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label>Celular *</label>
                    <input type="text" id="phone" required>
                </div>
                <div class="form-group">
                    <label>Barrio</label>
                    <input type="text" id="neighborhood">
                </div>
                <div class="form-group">
                    <label>Ciudad *</label>
                    <input type="text" id="city" required>
                </div>
                <div class="form-group">
                    <label>Provincia *</label>
                    <select id="province" required>
                        <option value="" disabled selected>Seleccionar provincia</option>
                        <option value="CABA">CABA</option>
                        <option value="Buenos Aires">Buenos Aires</option>
                        <option value="Catamarca">Catamarca</option>
                        <option value="Chaco">Chaco</option>
                        <option value="Chubut">Chubut</option>
                        <option value="C√≥rdoba">C√≥rdoba</option>
                        <option value="Corrientes">Corrientes</option>
                        <option value="Entre R√≠os">Entre R√≠os</option>
                        <option value="Formosa">Formosa</option>
                        <option value="Jujuy">Jujuy</option>
                        <option value="La Pampa">La Pampa</option>
                        <option value="La Rioja">La Rioja</option>
                        <option value="Mendoza">Mendoza</option>
                        <option value="Misiones">Misiones</option>
                        <option value="Neuqu√©n">Neuqu√©n</option>
                        <option value="R√≠o Negro">R√≠o Negro</option>
                        <option value="Salta">Salta</option>
                        <option value="San Juan">San Juan</option>
                        <option value="San Luis">San Luis</option>
                        <option value="Santa Cruz">Santa Cruz</option>
                        <option value="Santa Fe">Santa Fe</option>
                        <option value="Santiago del Estero">Santiago del Estero</option>
                        <option value="Tierra del Fuego">Tierra del Fuego</option>
                        <option value="Tucum√°n">Tucum√°n</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>C√≥digo Postal *</label>
                    <input type="text" id="postalCode" required>
                </div>
                <p class="payment-note">
                    üí∏ Pod√©s abonar por transferencia al Alias: <strong>NEXOART</strong>
                </p>
                <button type="submit" class="checkout-btn">
                    ENVIAR PEDIDO
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/></svg>
                </button>
            </form>
        </div>
    </div>
    <footer>
        <p>¬© 2025 FATALITY | Dise√±ado para durar.</p>
    </footer>
    <script>
        const products = [];
        const colors = {
            'blanco': '#ffffff',
            'negro': '#222222',
            'rojo': '#e63946',
            'amarillo': '#f4d35e',
            'azul': '#1d3557'
        };
        const colorNames = {
            '#ffffff': 'Blanco',
            '#222222': 'Negro',
            '#e63946': 'Rojo',
            '#f4d35e': 'Amarillo',
            '#1d3557': 'Azul'
        };
        const stampImages = [
            '001.jpg', '002.jpg', '003.jpg', '004.jpg', '005.jpg',
            '006.jpg', '007.jpg', '008.jpg', '009.jpg', '010.jpg',
            '011.jpg', '012.jpg', '013.jpg', '014.jpg', '015.jpg',
            '016.jpg', '017.jpg', '018.jpg', '019.jpg', '020.jpg',
            '021.jpg', '022.jpg', '023.jpg', '024.jpg', '025.jpg',
            '026.jpg', '027.jpg', '028.jpg', '029.jpg', '030.jpg',
            '031.jpg', '032.jpg', '033.jpg', '034.jpg', '035.jpg',
            '036.jpg', '037.jpg', '038.jpg', '039.jpg', '040.jpg',
            '041.jpg','000.jpg'
        ];
        for (let i = 0; i < 100; i++) {
            const stampIndex = i % stampImages.length;
            products.push({
                id: i + 1,
                name: `Remera Modelo Fatality #${i + 1}`,
                price: 15000 + (Math.floor(Math.random() * 5) * 1000),
                stamp: stampImages[stampIndex],
                defaultColor: 'blanco'
            });
        }

        // Carga segura del carrito
        let cart = [];
        const stored = localStorage.getItem('fatalityCart');
        if (stored) {
            try {
                const parsed = JSON.parse(stored);
                if (Array.isArray(parsed)) {
                    cart = parsed.map(item => ({
                        id: item.id || 0,
                        name: item.name || 'Producto',
                        stamp: item.stamp || '',
                        price: Number(item.price) || 0,
                        color: item.color || 'Blanco',
                        size: item.size || 'M',
                        qty: Number(item.qty) || 1
                    }));
                }
            } catch (e) {
                cart = [];
            }
        }

        const grid = document.getElementById('products-grid');
        const audio = document.getElementById('bg-music');
        const musicToggle = document.getElementById('music-toggle');

        audio.volume = 0.4;
        audio.play().catch(() => {});

        function toggleMusic() {
            if (audio.paused) {
                audio.play();
                musicToggle.innerHTML = 'üîä';
            } else {
                audio.pause();
                musicToggle.innerHTML = 'üîá';
            }
        }

        const tshirtSVG = (colorHex) => `
            <svg viewBox="0 0 512 512" class="tshirt-svg">
                <path fill="${colorHex}" d="M378.5,64.5c-15.8,18.1-40.8,24.5-62.5,24.5c-22,0-47.8-6.8-63-25c-4-4.8-11-5.8-16.3-2.2l-96,64
                c-6.6,4.4-8.8,13.1-5,20.3l38.6,73.1c4.2,8,14.6,10.2,21.9,4.7l13.8-10.4v238.5c0,11,9,20,20,20h224c11,0,20-9,20-20V213.5l13.8,10.4
                c7.3,5.5,17.7,3.3,21.9-4.7l38.6-73.1c3.8-7.2,1.6-15.9-5-20.3l-96-64C417.5,58.3,407.5,55.8,378.5,64.5z" />
                <path fill="#000" opacity="0.18" d="M378.5,64.5c-15.8,18.1-40.8,24.5-62.5,24.5c-22,0-47.8-6.8-63-25c-4-4.8-11-5.8-16.3-2.2l-96,64
                c-6.6,4.4-8.8,13.1-5,20.3l38.6,73.1c4.2,8,14.6,10.2,21.9,4.7l13.8-10.4v238.5c0,11,9,20,20,20h224c11,0,20-9,20-20V213.5l13.8,10.4
                c7.3,5.5,17.7,3.3,21.9-4.7l38.6-73.1c3.8-7.2,1.6-15.9-5-20.3l-96-64C417.5,58.3,407.5,55.8,378.5,64.5z" style="mix-blend-mode: multiply;"/>
            </svg>
        `;

        products.forEach(product => {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.innerHTML = `
                <div class="tshirt-visual">
                    <div id="svg-container-${product.id}">${tshirtSVG(colors[product.defaultColor])}</div>
                    <div class="stamp-area">
                        <img src="${product.stamp}" alt="Estampa del producto" class="stamp-img">
                    </div>
                </div>
                <div class="product-info">
                    <h3 class="product-title">${product.name}</h3>
                    <div class="product-price">$${product.price.toLocaleString('es-AR')}</div>
                    <div class="controls">
                        <span class="label">Color</span>
                        <div class="color-options">
                            <div class="color-btn active" style="background:${colors.blanco}" data-color="blanco" onclick="selectColor(${product.id}, 'blanco', '${colors.blanco}', this)"></div>
                            <div class="color-btn" style="background:${colors.negro}" data-color="negro" onclick="selectColor(${product.id}, 'negro', '${colors.negro}', this)"></div>
                            <div class="color-btn" style="background:${colors.rojo}" data-color="rojo" onclick="selectColor(${product.id}, 'rojo', '${colors.rojo}', this)"></div>
                            <div class="color-btn" style="background:${colors.amarillo}" data-color="amarillo" onclick="selectColor(${product.id}, 'amarillo', '${colors.amarillo}', this)"></div>
                            <div class="color-btn" style="background:${colors.azul}" data-color="azul" onclick="selectColor(${product.id}, 'azul', '${colors.azul}', this)"></div>
                        </div>
                        <span class="label">Talle</span>
                        <select class="size-select" id="size-${product.id}">
                            <option value="S">S</option>
                            <option value="M" selected>M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                            <option value="XXL">XXL</option>
                        </select>
                    </div>
                    <button class="add-btn" onclick="addToCart(${product.id})">AGREGAR AL CARRITO</button>
                </div>
            `;
            grid.appendChild(card);
        });

        function selectColor(prodId, colorKey, colorHex, btn) {
            document.getElementById(`svg-container-${prodId}`).innerHTML = tshirtSVG(colorHex);
            const parent = btn.parentElement;
            parent.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function addToCart(prodId) {
            const product = products.find(p => p.id === prodId);
            if (!product) return;

            const selectedColorBtn = document.querySelector(`#products-grid .product-card:nth-child(${prodId}) .color-btn.active`);
            const colorKey = selectedColorBtn ? selectedColorBtn.dataset.color : 'blanco';
            const colorName = colorNames[colors[colorKey]] || 'Blanco';

            const size = document.getElementById(`size-${prodId}`).value;

            const existingItem = cart.find(item => item.id === prodId && item.color === colorName && item.size === size);
            if (existingItem) {
                existingItem.qty += 1;
            } else {
                cart.push({
                    id: prodId,
                    name: product.name,
                    stamp: product.stamp,
                    price: product.price,
                    color: colorName,
                    size: size,
                    qty: 1
                });
            }
            localStorage.setItem('fatalityCart', JSON.stringify(cart));
            updateCartUI();
            const cartIcon = document.querySelector('.cart-icon');
            cartIcon.style.transform = 'scale(1.3)';
            setTimeout(() => { cartIcon.style.transform = 'scale(1)'; }, 200);
        }

        function updateCartUI() {
            const countEl = document.getElementById('cart-count');
            const itemsContainer = document.getElementById('cart-items');
            const totalEl = document.getElementById('cart-total');

            const totalItems = cart.reduce((sum, item) => sum + (item.qty || 0), 0);
            countEl.textContent = totalItems;

            if (cart.length === 0) {
                itemsContainer.innerHTML = '<p style="text-align:center; color:#999;">El carrito est√° vac√≠o</p>';
                totalEl.textContent = '0';
                return;
            }

            let html = '';
            let totalPrice = 0;

            cart.forEach((item, index) => {
                const qty = item.qty || 1;
                const price = Number(item.price) || 0;
                const subtotal = price * qty;
                totalPrice += subtotal;

                html += `
                    <div class="cart-item">
                        <img class="cart-item-img" src="${item.stamp}">
                        <div style="flex:1;">
                            <strong>${item.name}</strong><br>
                            <small>Color: ${item.color} | Talle: ${item.size} | Cantidad: ${qty}</small>
                        </div>
                        <div style="text-align:right;">
                            <strong>$${subtotal.toLocaleString('es-AR')}</strong><br>
                            <button class="delete-btn" onclick="removeFromCart(${index})">Eliminar</button>
                        </div>
                    </div>
                `;
            });

            itemsContainer.innerHTML = html;
            totalEl.textContent = totalPrice.toLocaleString('es-AR');
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            localStorage.setItem('fatalityCart', JSON.stringify(cart));
            updateCartUI();
        }

        function openCart() { 
            updateCartUI();
            document.getElementById('cartModal').style.display = 'block'; 
        }
        function closeCart() { document.getElementById('cartModal').style.display = 'none'; }

        function sendToWhatsApp(e) {
            e.preventDefault();
            if(cart.length === 0) {
                alert("Agrega productos antes de enviar.");
                return;
            }
            const required = ['name', 'dni', 'email', 'phone', 'city', 'province', 'postalCode'];
            for (let id of required) {
                if (!document.getElementById(id).value.trim()) {
                    alert('Completa todos los campos obligatorios');
                    return;
                }
            }
            let orderText = "üöÄ *HOLA FATALITY!!! Este es mi pedido* üöÄ%0A%0A";
            orderText += "üõí *PRODUCTOS*%0A";
            let total = 0;
            cart.forEach(item => {
                const subtotal = (item.price || 0) * (item.qty || 1);
                total += subtotal;
                orderText += `üî• *${item.name}*%0A`;
                orderText += `   üé® Color: ${item.color}%0A`;
                orderText += `   üìè Talle: ${item.size}%0A`;
                orderText += `   üî¢ Cantidad: ${item.qty || 1}%0A`;
                orderText += `   üí∞ Subtotal: $${subtotal.toLocaleString('es-AR')}%0A%0A`;
            });
            orderText += `%0Aüí∞ *TOTAL: $${total.toLocaleString('es-AR')}*%0A%0A`;
            orderText += "üì¶ *DATOS DE ENV√çO*%0A";
            orderText += `üë§ ${document.getElementById('name').value}%0A`;
            orderText += `üÜî DNI: ${document.getElementById('dni').value}%0A`;
            orderText += `üìß ${document.getElementById('email').value}%0A`;
            orderText += `üì± ${document.getElementById('phone').value}%0A`;
            if (document.getElementById('neighborhood').value) orderText += `üèòÔ∏è Barrio: ${document.getElementById('neighborhood').value}%0A`;
            orderText += `üèôÔ∏è ${document.getElementById('city').value}%0A`;
            orderText += `üåé ${document.getElementById('province').value}%0A`;
            orderText += `üìÆ CP: ${document.getElementById('postalCode').value}%0A%0A`;
            orderText += "üí≥ Transferencia a Alias: *NEXOART*%0A¬°Gracias! üñ§";
            const finalURL = `https://api.whatsapp.com/send?phone=+543489686939&text=${orderText}`;
            window.open(finalURL, '_blank');
        }

        // Inicializaci√≥n
        updateCartUI();
    </script>
</body>
</html>
"commit"




